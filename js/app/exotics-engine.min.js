var ExoticsAPI=function(b,a){this.debug=a||false;this.cache={};this.httpGet=function(c,e){var d=c;if(this.cache[d]==undefined){if(this.debug){console.log("Fetching "+d)}$.ajax({url:c,type:"GET",dataType:"json",success:function(f){this.cache[d]=f;e(f)}.bind(this),error:b})}else{if(this.debug){console.log("Serving "+d+" from cache")}e(this.cache[d])}},this.httpPost=function(c,f,e){var d=c+" "+JSON.stringify(f);if(this.cache[d]==undefined){if(this.debug){console.log("Fetching "+d)}$.ajax({url:c,type:"POST",contentType:"application/json",data:JSON.stringify(f),dataType:"json",success:function(g){this.cache[d]=g;e(g)}.bind(this),error:b})}else{if(this.debug){console.log("Serving "+d+" from cache")}e(this.cache[d])}};this.fetchProducts=function(c){this.httpGet("/app/products",c)};this.listBets=function(g,d,f,e){var c="/app/bets/list?";c+="group="+g+"&";if(d!=undefined){c+="team="+d+"&"}if(f!=undefined){c+="type="+f+"&"}this.httpGet(c,e)};this.fetchTeams=function(d){var c="/app/blobs?key=teams";this.httpGet(c,d)};this.fetchBlob=function(d,e){var c="/app/blobs?key="+d;this.httpGet(c,e)},this.fetchExpiries=function(c){this.httpGet("/app/expiries",c)};this.fetchPrice=function(d,c){this.httpPost("/app/bets/price",d,c)}};var MySelect=React.createClass({getInitialState:function(){return{options:this.props.options,value:this.props.value}},componentWillReceiveProps:function(a){if(JSON.stringify(this.state.options)!=JSON.stringify(a.options)){var b=this.state;b.options=a.options;var c=b.options.filter(function(d){return d.value==this.state.value}.bind(this));if(c.length==0){b.value=undefined}this.setState(b)}if(this.state.value!=a.value){var b=this.state;b.value=a.value;this.setState(b)}},renderSelect:function(){return React.DOM.select({className:this.props.className||"form-control",value:this.state.value,style:(this.state.value==undefined)?this.props.blankStyle:{},onChange:function(a){var c=a.target.value;var b=this.state;b.value=c;this.setState(b);this.props.changeHandler(this.props.name,c)}.bind(this),children:[(this.props.defaultOption!=undefined)?React.DOM.option({value:this.props.defaultOption.value,selected:this.state.value==this.props.defaultOption.value,children:this.props.defaultOption.label}):undefined,this.state.options.map(function(a){return React.DOM.option({value:a.value,selected:a.value==this.state.value,children:a.label||a.value})}.bind(this))]})},renderForm:function(){return React.DOM.div({className:"form-group",children:[React.DOM.label({children:this.props.label}),this.renderSelect()]})},render:function(){return(this.props.label!=undefined)?this.renderForm():this.renderSelect()}});var MyNumberInput=React.createClass({getInitialState:function(){return{value:this.props.value}},render:function(){return React.DOM.input({type:"number",min:this.props.min,max:this.props.max,value:this.state.value,className:"form-control text-center",onChange:function(b){var d=b.target.value;if((d!="")&&(d!=undefined)&&(d!=NaN)){var a=parseInt(d);var c=this.state;c.value=a;this.setState(c);this.props.changeHandler(a)}}.bind(this)})}});var ProductSelector=React.createClass({initOptionsHandler:function(a){return function(c){var b=this.state;b.options[a]=c;this.setState(b)}.bind(this)},getInitialState:function(){return{options:{product:[]},product:this.props.product}},fetchProducts:function(){var a=this.initOptionsHandler("product");this.props.exoticsApi.fetchProducts(a)},sortProducts:function(b,a){if(b.type<a.type){return -1}else{if(b.type>a.type){return 1}else{return 0}}},formatProductLabel:function(a){if(a==undefined){return undefined}else{return a.label}},formatProductValue:function(a){if(a==undefined){return undefined}else{return a.type}},formatProductOptions:function(a){return a.sort(this.sortProducts).map(function(b){return{label:this.formatProductLabel(b),value:this.formatProductValue(b)}}.bind(this))},changeHandler:function(a,c){if(this.state[a]!=c){var b=this.state;b[a]=c;this.setState(b);this.props.changeHandler(a,c)}},initialise:function(){this.fetchProducts()},componentDidMount:function(){this.initialise()},render:function(){return React.createElement(MySelect,{changeHandler:this.changeHandler,options:this.formatProductOptions(this.state.options.product),value:this.formatProductValue(this.state.product),blankStyle:this.props.blankStyle,className:this.props.className,defaultOption:this.props.defaultOption,label:this.props.label,name:this.props.name||"product"})}});var TeamSelector=React.createClass({initOptionsHandler:function(a){return function(c){var b=this.state;b.options[a]=c;this.setState(b)}.bind(this)},getInitialState:function(){return{options:{team:[],},item:JSON.parse(JSON.stringify(this.props.item))}},fetchTeams:function(){var a=this.initOptionsHandler("team");this.props.exoticsApi.fetchTeams(a)},sortTeams:function(b,a){if(b.team<a.team){return -1}else{if(b.team>a.team){return 1}else{return 0}}},formatTeamLabel:function(a){if((a.league==undefined)||(a.team==undefined)){return undefined}else{return a.team+" ("+a.league+")"}},formatTeamValue:function(a){if((a.league==undefined)||(a.team==undefined)){return undefined}else{return a.league+"/"+a.team}},formatTeamOptions:function(a){return a.sort(this.sortTeams).map(function(b){return{label:this.formatTeamLabel(b),value:this.formatTeamValue(b)}}.bind(this))},changeHandler:function(b,d){var e=d.split("/");var f=e[0];var a=e[1];var c=this.state;c.item.league=f;c.item.team=a;this.setState(c);this.props.changeHandler(c.item)},componentWillReceiveProps:function(a){if(JSON.stringify(this.state.item)!=JSON.stringify(a.item)){var b=this.state;b.item=a.item;this.setState(b)}},initialise:function(){this.fetchTeams()},componentDidMount:function(){this.initialise()},render:function(){return React.createElement(MySelect,{changeHandler:this.changeHandler,options:this.formatTeamOptions(this.state.options.team),value:this.formatTeamValue(this.state.item),blankStyle:this.props.blankStyle,className:this.props.className,defaultOption:this.props.defaultOption,label:this.props.label,name:this.props.name||"team"})}});var ExpirySelector=React.createClass({initOptionsHandler:function(a){return function(c){var b=this.state;b.options[a]=c;this.setState(b)}.bind(this)},getInitialState:function(){return{options:{expiry:[]},expiry:this.props.expiry}},fetchExpiries:function(){var a=this.initOptionsHandler("expiry");this.props.exoticsApi.fetchExpiries(a)},formatExpiryOptions:function(a){return a},changeHandler:function(a,c){if(this.state[a]!=c){var b=this.state;b[a]=c;this.setState(b);this.props.changeHandler(a,c)}},initialise:function(){this.fetchExpiries()},componentDidMount:function(){this.initialise()},render:function(){return React.createElement(MySelect,{changeHandler:this.changeHandler,options:this.formatExpiryOptions(this.state.options.expiry),value:this.state.expiry,blankStyle:this.props.blankStyle,className:this.props.className,defaultOption:this.props.defaultOption,label:this.props.label||"At",name:this.props.name||"expiry"})}});var SelectorRow=React.createClass({getInitialState:function(){return{item:this.props.item}},changeHandler:function(c){if(JSON.stringify(this.state.item)!=JSON.stringify(c)){var b=this.state;for(var a in c){if(c[a]!=b.item[a]){b.item[a]=c[a]}}this.setState(b);this.props.changeHandler(this.props.item.id,c)}},deleteHandler:function(){this.props.deleteHandler(this.props.item.id)},componentWillReceiveProps:function(a){if(JSON.stringify(this.state.item)!=JSON.stringify(a.item)){var b=this.state;b.item=a.item;this.setState(b)}},render:function(){return React.DOM.tr({children:[React.DOM.td({style:{"margin-left":"0px","padding-left":"0px"},children:React.createElement(this.props.selectorClass,{exoticsApi:this.props.exoticsApi,item:this.state.item,changeHandler:this.changeHandler,blankStyle:this.props.blankStyle,defaultOption:this.props.defaultOption})}),React.DOM.td({style:{"margin-right":"0px","padding-right":"0px"},children:React.DOM.a({className:"btn btn-secondary",children:React.DOM.i({className:"glyphicon glyphicon-remove"}),onClick:this.deleteHandler})})]})}});var SelectorTable=React.createClass({uuid:function(){return Math.round(Math.random()*10000000000000000)},initItems:function(a){if(a.length==0){a.push({})}for(var b=0;b<a.length;b++){var c=a[b];c.id=this.uuid()}return a},getInitialState:function(){return{items:this.initItems(this.props.items)}},addHandler:function(){var b=this.state;var a=b.items;a.push({id:this.uuid()});b.items=a;this.setState(b);this.props.changeHandler(b.items)},changeHandler:function(e,d){var c=this.state;for(var a=0;a<c.items.length;a++){var b=c.items[a];if(b.id==e){for(attr in d){b[attr]=d[attr]}}}this.setState(c);this.props.changeHandler(c.items)},deleteHandler:function(c){if(this.state.items.length>1){var b=this.state;var a=b.items.filter(function(d){return d.id!=c});b.items=a;this.setState(b);this.props.changeHandler(b.items)}},render:function(){return React.DOM.div({className:"form-group",children:[React.DOM.label({children:this.props.label}),React.DOM.table({className:"table",style:{"margin-top":"0px","margin-bottom":"0px"},children:React.DOM.tbody({children:this.state.items.map(function(a){return React.createElement(SelectorRow,{selectorClass:this.props.selectorClass,item:a,exoticsApi:this.props.exoticsApi,blankStyle:this.props.blankStyle,defaultOption:this.props.defaultOption,changeHandler:this.changeHandler,deleteHandler:this.deleteHandler})}.bind(this))})}),React.DOM.div({className:"text-center",children:React.DOM.a({className:"btn btn-secondary",style:{"margin-top":"10px"},onClick:function(){this.addHandler()}.bind(this),children:this.props.addLabel})})]})}});var GridLayout=React.createClass({initItem:function(a,b){return React.DOM.div({className:"col-xs-"+b,children:a})},initRow:function(a){var b=12/a.length;return React.DOM.div({className:"row",children:Array.isArray(a)?a.map(function(c){return this.initItem(c,b)}.bind(this)):this.initItem(a,12)})},render:function(){return React.DOM.div({children:this.props.rows.map(function(a){return this.initRow(a)}.bind(this))})}});var InlineList=React.createClass({render:function(){return React.DOM.ul({style:this.props.style||{},className:"list-inline",children:this.props.items.map(function(a){return React.DOM.li({className:a.right?"pull-right":undefined,style:{width:a.width+"px"},children:a.item})})})}});var Paginator=React.createClass({initItems:function(k,h,c){var a=Math.floor(k.nItems/k.nRows);if(0!=k.nItems%k.nRows){a+=1}var g=Math.floor(k.offset/k.nRows);var e=h.length*Math.floor(g/h.length);var f=Math.min(a,e+h.length);var d=[];if(e!=0){d.push(React.DOM.li({onClick:c.bind(null,(e-1)*k.nRows),children:React.DOM.a({children:React.DOM.span({dangerouslySetInnerHTML:{__html:"&laquo;"}})})}))}for(var b=e;b<f;b++){var j=React.DOM.li({className:(g==b)?"active":"",onClick:c.bind(null,b*k.nRows),children:React.DOM.a({children:(b+1).toString()})});d.push(j)}if(f!=a){d.push(React.DOM.li({onClick:c.bind(null,f*k.nRows),children:React.DOM.a({children:React.DOM.span({dangerouslySetInnerHTML:{__html:"&raquo;"}})})}))}return d},render:function(){return React.DOM.nav({children:React.DOM.ul({className:"pagination pagination-sm",children:this.initItems(this.props.table,this.props.paginator,this.props.clickHandler)})})}});var Tabs=React.createClass({render:function(){return React.DOM.ul({className:"nav nav-tabs",children:this.props.tabs.map(function(a){return React.DOM.li({className:(a.name==this.props.selected)?"active":"",onClick:this.props.clickHandler.bind(null,a),children:React.DOM.a({children:a.label})})}.bind(this))})}});var MiniLeagueForm=React.createClass({initOptionsHandler:function(a){return function(c){var b=this.state;b.options[a]=c;this.setState(b)}.bind(this)},initBet:function(a){if(a.versus==undefined){a.versus=[]}return a},getInitialState:function(){return{options:{payoff:[{value:"Top"},{value:"Bottom"}]},bet:this.initBet(this.props.bet)}},teamChangeHandler:function(b){if((this.state.bet.league!=b.league)||(this.state.bet.team!=b.team)){var a=this.state;a.bet.league=b.league;a.bet.team=b.team;this.setState(a);this.updatePrice(this.state.bet)}},versusChangeHandler:function(a){var b=this.state;b.bet.versus=a.map(function(c){return{league:c.league,team:c.team}});this.setState(b);this.updatePrice(this.state.bet)},changeHandler:function(a,c){if(this.state.bet[a]!=c){var b=this.state;b.bet[a]=c;this.setState(b);this.updatePrice(this.state.bet)}},isComplete:function(a){if((a.league==undefined)||(a.team==undefined)||(a.payoff==undefined)||(a.expiry==undefined)){return false}if(a.versus.length==0){return false}for(var c=0;c<a.versus.length;c++){var d=a.versus[c];if((d.league==undefined)||(d.team==undefined)){return false}}var b=[a.team];for(var c=0;c<a.versus.length;c++){var d=a.versus[c];if(b.indexOf(d.team)==-1){b.push(d.team)}}if(b.length!=(a.versus.length+1)){return false}return true},updatePrice:function(a){if(this.isComplete(a)){this.props.updatePriceHandler("mini_league",a)}else{this.props.resetPriceHandler()}},initialise:function(){this.updatePrice(this.state.bet)},componentDidMount:function(){this.initialise()},render:function(){return React.createElement(GridLayout,{rows:[React.createElement(TeamSelector,{exoticsApi:this.props.exoticsApi,item:{league:this.state.bet.league,team:this.state.bet.team},changeHandler:this.teamChangeHandler,blankStyle:this.props.blankStyle,label:"Team",defaultOption:{label:"Select"}}),React.createElement(SelectorTable,{selectorClass:TeamSelector,items:this.state.bet.versus,exoticsApi:this.props.exoticsApi,blankStyle:this.props.blankStyle,changeHandler:this.versusChangeHandler,label:"Versus",addLabel:"Add Team",defaultOption:{label:"Select"}}),[React.createElement(MySelect,{label:"Position",name:"payoff",options:this.state.options.payoff,value:this.state.bet.payoff,changeHandler:this.changeHandler,blankStyle:this.props.blankStyle,defaultOption:{label:"Select"}}),React.createElement(ExpirySelector,{exoticsApi:this.props.exoticsApi,expiry:this.state.bet.expiry,changeHandler:this.changeHandler,blankStyle:this.props.blankStyle,defaultOption:{label:"Select"}})]]})}});var SeasonMatchBetForm=React.createClass({initOptionsHandler:function(a){return function(c){var b=this.state;b.options[a]=c;this.setState(b)}.bind(this)},getInitialState:function(){return{options:{versus:[]},bet:this.props.bet}},fetchVersus:function(){var a=this.initOptionsHandler("versus");this.props.exoticsApi.fetchBlob("smb_versus",a)},filterVersus:function(b,a){return b.filter(function(c){return(c.team==a)&&(c.versus!=a)})},formatVersusLabel:function(a){if((a.league==undefined)||(a.versus==undefined)){return undefined}else{return a.versus+" ("+a.league+")"}},formatVersusOptions:function(a){return a.map(function(b){return{label:this.formatVersusLabel(b),value:b.versus}}.bind(this))},hasVersus:function(a,c){var b=this.state.options.versus.filter(function(d){return(d.team==a)&&(d.versus==c)});return b.length!=0},teamChangeHandler:function(b){if((this.state.bet.league!=b.league)||(this.state.bet.team!=b.team)){var a=this.state;a.bet.league=b.league;a.bet.team=b.team;if(!this.hasVersus(b.team,a.bet.versus)){a.bet.versus=undefined}this.setState(a);this.updatePrice(this.state.bet)}},changeHandler:function(a,c){if(this.state.bet[a]!=c){var b=this.state;b.bet[a]=c;this.setState(b);this.updatePrice(this.state.bet)}},isComplete:function(a){return((a.league!=undefined)&&(a.team!=undefined)&&(a.versus!=undefined)&&(a.team!=a.versus)&&(a.expiry!=undefined))},updatePrice:function(a){if(this.isComplete(a)){this.props.updatePriceHandler("season_match_bet",a)}else{this.props.resetPriceHandler()}},initialise:function(){this.fetchVersus();this.updatePrice(this.state.bet)},componentDidMount:function(){this.initialise()},render:function(){return React.createElement(GridLayout,{rows:[React.createElement(TeamSelector,{exoticsApi:this.props.exoticsApi,item:{league:this.state.bet.league,team:this.state.bet.team},changeHandler:this.teamChangeHandler,blankStyle:this.props.blankStyle,label:"Team",defaultOption:{label:"Select"}}),React.createElement(MySelect,{label:"Versus",name:"versus",options:this.formatVersusOptions(this.filterVersus(this.state.options.versus,this.state.bet.team)),value:this.state.bet.versus,changeHandler:this.changeHandler,blankStyle:this.props.blankStyle,defaultOption:{label:"Select"}}),React.createElement(ExpirySelector,{exoticsApi:this.props.exoticsApi,expiry:this.state.bet.expiry,changeHandler:this.changeHandler,blankStyle:this.props.blankStyle,defaultOption:{label:"Select"}})]})}});var SingleTeamOutrightForm=React.createClass({initOptionsHandler:function(a){return function(c){var b=this.state;b.options[a]=c;this.setState(b)}.bind(this)},getInitialState:function(){return{options:{payoff:[]},bet:this.props.bet}},fetchPayoffs:function(){var a=this.initOptionsHandler("payoff");this.props.exoticsApi.fetchBlob("outright_payoffs",a)},filterPayoffs:function(b,a){return b.filter(function(c){return c.team==a})},formatPayoffOptions:function(a){return a.map(function(b){return{value:b.payoff}})},hasPayoff:function(a,b){var c=this.state.options.payoff.filter(function(d){return(d.team==a)&&(d.payoff==b)});return c.length!=0},teamChangeHandler:function(b){if((this.state.bet.league!=b.league)||(this.state.bet.team!=b.team)){var a=this.state;a.bet.league=b.league;a.bet.team=b.team;if(!this.hasPayoff(b.team,this.state.bet.payoff)){a.bet.payoff=undefined}this.setState(a);this.updatePrice(this.state.bet)}},changeHandler:function(a,c){if(this.state.bet[a]!=c){var b=this.state;b.bet[a]=c;this.setState(b);this.updatePrice(this.state.bet)}},isComplete:function(a){return((a.league!=undefined)&&(a.team!=undefined)&&(a.payoff!=undefined)&&(a.expiry!=undefined))},updatePrice:function(a){if(this.isComplete(a)){this.props.updatePriceHandler("single_team_outright",a)}else{this.props.resetPriceHandler()}},initialise:function(){this.fetchPayoffs();this.updatePrice(this.state.bet)},componentDidMount:function(){this.initialise()},render:function(){return React.createElement(GridLayout,{rows:[React.createElement(TeamSelector,{exoticsApi:this.props.exoticsApi,item:{league:this.state.bet.league,team:this.state.bet.team},changeHandler:this.teamChangeHandler,blankStyle:this.props.blankStyle,label:"Team",defaultOption:{label:"Select"}}),[React.createElement(MySelect,{label:"Position",name:"payoff",options:this.formatPayoffOptions(this.filterPayoffs(this.state.options.payoff,this.state.bet.team)),value:this.state.bet.payoff,changeHandler:this.changeHandler,blankStyle:this.props.blankStyle,defaultOption:{label:"Select"}}),React.createElement(ExpirySelector,{exoticsApi:this.props.exoticsApi,expiry:this.state.bet.expiry,changeHandler:this.changeHandler,blankStyle:this.props.blankStyle,defaultOption:{label:"Select"}})]]})}});var BrowseBetsRow=React.createClass({render:function(){return React.DOM.tr({children:[React.DOM.td({children:[React.DOM.h5({children:[this.props.bet.description.selection,React.DOM.span({style:{"margin-left":"10px"},className:"label label-"+this.props.bet.description.group.level,children:this.props.bet.description.group.label})]}),React.DOM.p({dangerouslySetInnerHTML:{__html:this.props.bet.description.market}})]}),React.DOM.td({className:"text-center",children:React.DOM.span({className:"price",children:this.props.bet.price})}),React.DOM.td({children:React.DOM.a({className:"btn btn-secondary",onClick:function(){this.props.clickHandler(this.props.bet)}.bind(this),children:React.DOM.i({className:"glyphicon glyphicon-pencil"})})})]})}});var BrowseBetsTable=React.createClass({getInitialState:function(){return{bet:undefined,tab:this.props.tab,bets:[]}},listBetsHandler:function(b){var a=this.state;a.bets=b;this.setState(a);this.props.dataLoadedHandler(b.length)},componentDidMount:function(){this.props.exoticsApi.listBets(this.props.tab,undefined,undefined,this.listBetsHandler)},componentWillReceiveProps:function(b){var c=this.state;var a=false;if(b.tab!=this.props.tab){c.tab=b.tab;a=true}if(a){this.setState(c);this.props.exoticsApi.listBets(this.state.tab,undefined,undefined,this.listBetsHandler)}},handleClicked:function(a){var b=this.state;b.bet=a;this.setState(b);this.props.clickHandler(a)},render:function(){return React.DOM.table({className:"table table-condensed table-bordered table-striped",children:React.DOM.tbody({children:this.state.bets.slice(this.props.rowOffset,this.props.rowOffset+this.props.nRows).map(function(a){return React.createElement(BrowseBetsRow,{bet:a,clickHandler:this.handleClicked})}.bind(this))})})}});var BrowseBetsPanel=React.createClass({getInitialState:function(){return{tab:"popular",nRows:5,nItems:undefined,rowOffset:0,paginatorLength:5,teams:[]}},handleStepClicked:function(a){this.props.stepChangeHandler(1,a)},handleTabClicked:function(a){var b=this.state;b.tab=a.name;this.setState(b)},handlePaginatorClicked:function(a){var b=this.state;b.rowOffset=a;this.setState(b)},handleDataLoaded:function(b){var a=this.state;a.nItems=b;this.setState(a)},handleCreateBet:function(){this.props.stepChangeHandler(1,undefined)},render:function(){return React.DOM.div({children:[React.createElement(ProcessSteps,{steps:this.props.steps,currentStep:0}),React.DOM.div({children:React.createElement(Tabs,{tabs:[{name:"popular",label:"Popular"},{name:"daily",label:"Daily"},{name:"jackpots",label:"Jackpots"},{name:"my_bets",label:"My Bets"}],selected:this.state.tab,clickHandler:this.handleTabClicked})}),React.createElement(InlineList,{items:[{item:React.createElement(TeamSelector,{exoticsApi:this.props.exoticsApi,className:"form-control input-sm btn-secondary",item:{},defaultOption:{label:"All Teams",},changeHandler:function(a){console.log(JSON.stringify(a))}}),width:100},{item:React.createElement(ProductSelector,{exoticsApi:this.props.exoticsApi,className:"form-control input-sm btn-secondary",item:{},defaultOption:{label:"All Exotics"},changeHandler:function(a,b){console.log(a+"="+b)}}),width:100},{item:React.DOM.a({className:"btn btn-sm btn-primary",onClick:this.handleCreateBet,children:"Build My Own"}),width:100,right:true}],style:{"margin-right":"7px"}}),React.createElement(BrowseBetsTable,{exoticsApi:this.props.exoticsApi,clickHandler:this.handleStepClicked,dataLoadedHandler:this.handleDataLoaded,rowOffset:this.state.rowOffset,nRows:this.state.nRows,tab:this.state.tab,team:this.state.team}),(this.state.nItems!=undefined)?React.DOM.div({className:"text-center",children:React.createElement(Paginator,{table:{nItems:this.state.nItems,nRows:this.state.nRows,offset:this.state.rowOffset},paginator:{length:this.state.paginatorLength},clickHandler:this.handlePaginatorClicked})}):null]})}});var EditBetForm=React.createClass({initBet:function(a){return(a!=undefined)?a:{type:"season_match_bet"}},getInitialState:function(){return{bet:this.initBet(this.props.bet),products:[]}},productsHandler:function(b){var a=this.state;a.products=b;this.setState(a)},componentDidMount:function(){this.props.exoticsApi.fetchProducts(this.productsHandler)},productChangeHandler:function(a,c){var b=this.state;b.bet={type:c};this.setState(b)},loadProductForm:function(type){for(var i=0;i<this.state.products.length;i++){var product=this.state.products[i];if(type==product.type){return eval(product.form)}}return undefined},updatePrice:function(b,a){this.props.priceChangeHandler("[updating ..]");this.props.exoticsApi.fetchPrice({type:b,bet:a},function(c){this.props.priceChangeHandler(c.price)}.bind(this));this.props.productChangeHandler({type:b,bet:a})},resetPrice:function(){this.props.priceChangeHandler("[..]");this.props.productChangeHandler(undefined)},render:function(){return React.DOM.div({children:[React.createElement(ProductSelector,{exoticsApi:this.props.exoticsApi,className:"form-control btn-primary input-lg",product:this.state.bet,changeHandler:this.productChangeHandler}),React.DOM.p({className:"help-block",children:(this.state.products.length>0)?React.DOM.i({children:this.state.products.filter(function(a){return a.type==this.state.bet.type}.bind(this))[0]["description"]}):undefined}),(this.state.products.length!=0)?React.createElement(this.loadProductForm(this.state.bet.type),{exoticsApi:this.props.exoticsApi,bet:this.state.bet,blankStyle:{border:"3px solid #59a0df"},updatePriceHandler:this.updatePrice,resetPriceHandler:this.resetPrice}):undefined]})}});var EditBetPanel=React.createClass({getInitialState:function(){return{bet:this.props.bet,price:"[..]"}},productChangeHandler:function(b){var a=this.state;a.bet=b;this.setState(a)},priceChangeHandler:function(a){var b=this.state;b.price=a;this.setState(b)},render:function(){return React.DOM.div({children:[React.createElement(ProcessSteps,{steps:this.props.steps,currentStep:1}),React.DOM.div({className:"form-group",children:React.DOM.h3({className:"current-price text-center",style:{margin:"20 0 10px"},children:["Current price: ",React.DOM.span({id:"price",children:this.state.price})]})}),React.createElement(EditBetForm,{exoticsApi:this.props.exoticsApi,productChangeHandler:this.productChangeHandler,priceChangeHandler:this.priceChangeHandler,bet:this.props.bet}),React.DOM.div({className:"text-center",style:{margin:"5px 0 20px"},children:[React.DOM.button({className:"btn btn-secondary",style:{width:"100px","margin-right":"3px"},children:"Cancel",onClick:function(){this.props.stepChangeHandler(0,undefined)}.bind(this)}),React.DOM.button({className:"btn btn-primary",style:{width:"100px","margin-left":"3px"},children:"Next",onClick:function(){if(this.state.bet!=undefined){this.props.stepChangeHandler(2,this.state.bet)}}.bind(this)})]})]})}});var PlaceBetPanel=React.createClass({getInitialState:function(){return{confirmMessage:undefined,bet:undefined,size:2}},showBetHandler:function(b){var a=this.state;a.bet=b;this.setState(a)},componentDidMount:function(){this.props.exoticsApi.fetchPrice(this.props.bet,this.showBetHandler)},sizeChangeHandler:function(a){var b=this.state;b.size=a;this.setState(b)},render:function(){return React.DOM.div({children:[React.createElement(ProcessSteps,{steps:this.props.steps,currentStep:2}),(this.state.bet!=undefined)?[React.DOM.h2({className:"heading text-center",children:[this.state.bet.description.selection,React.DOM.small({className:"text-center",dangerouslySetInnerHTML:{__html:this.state.bet.description.market}})]}),(this.state.confirmMessage==undefined)?React.DOM.div({className:"form-group",children:React.DOM.h3({className:"current-price text-center",style:{margin:"0 0 10px"},children:["Your price: ",React.DOM.span({children:this.state.bet.price})]})}):React.DOM.div({className:"form-group",children:React.DOM.h3({className:"current-price text-center",style:{margin:"0 0 10px"},children:[React.DOM.span({style:{color:"#FFF"},children:"Â£"+this.state.size+" @ "}),React.DOM.span({children:this.state.bet.price})]})})]:undefined,(this.state.confirmMessage==undefined)?React.DOM.form({className:"form-horizontal",children:React.DOM.div({className:"form-group",children:[React.DOM.label({className:"col-xs-12 text-center control-label",children:"Your size"}),React.DOM.div({className:"col-xs-8 col-xs-offset-2",children:React.createElement(MyNumberInput,{min:2,max:1000,value:this.state.size,changeHandler:this.sizeChangeHandler})})]})}):undefined,(this.state.confirmMessage!=undefined)?React.DOM.div({className:"alert alert-success",children:[React.DOM.i({className:"glyphicon glyphicon-ok"}),this.state.confirmMessage]}):undefined,(this.state.confirmMessage==undefined)?React.DOM.div({className:"text-center",style:{margin:"5px 0 20px"},children:[React.DOM.button({className:"btn btn-secondary",style:{width:"100px","margin-right":"3px"},children:"Cancel",onClick:function(){this.props.stepChangeHandler(0,undefined)}.bind(this)}),React.DOM.button({className:"btn btn-primary",style:{width:"100px","margin-left":"3px"},children:"Place Bet",onClick:function(){var a=this.state;a.confirmMessage="Your bet has been placed!";this.setState(a)}.bind(this)})]}):React.DOM.div({className:"text-center",children:React.DOM.div({className:"text-center",style:{margin:"5px 0 20px"},children:React.DOM.button({className:"btn btn-primary",children:"Bet Again",onClick:function(){var a=this.state;a.confirmMessage=undefined;this.setState(a);this.props.stepChangeHandler(0,undefined)}.bind(this)})})})]})}});var ProcessStep=React.createClass({render:function(){return React.DOM.div({className:"col-xs-"+this.props.width+" bs-wizard-step "+this.props.status,children:[React.DOM.div({className:"progress",children:React.DOM.div({className:"progress-bar"})}),React.DOM.a({href:"#",className:"bs-wizard-dot"}),React.DOM.div({className:"bs-wizard-info text-center",children:this.props.label})]})}});var ProcessSteps=React.createClass({initSteps:function(h,a){var g=[];var b=12/h.length;for(var e=0;e<h.length;e++){var j=h[e].label;var d;if(e<a){d="complete"}else{if(e==a){d="active"}else{d="disabled"}}var f={width:b,step:e+1,label:j,status:d};var c=React.createElement(ProcessStep,f);g.push(c)}return g},render:function(){return React.DOM.div({className:"row bs-wizard",children:this.initSteps(this.props.steps,this.props.currentStep)})}});var App=React.createClass({getInitialState:function(){return{step:0,bet:undefined}},stepChangeHandler:function(b,a){var c=this.state;c.step=b;c.bet=a;this.setState(c)},render:function(){return React.DOM.div({children:[React.DOM.div({className:"header clearfix",children:React.DOM.h1({children:"Team Exotics"})}),React.createElement(this.props.steps[this.state.step].klass,{exoticsApi:this.props.exoticsApi,steps:this.props.steps,stepChangeHandler:this.stepChangeHandler,bet:this.state.bet}),React.DOM.footer({className:"footer",children:["Powered by",React.DOM.img({className:"img-responsive",src:"img/iosport.png",alt:"ioSport"})]})]})}});var ajaxErrHandler=function(c,a,b){console.log(c.responseText)};var Main=function(){var b=React.createElement(App,{exoticsApi:new ExoticsAPI(ajaxErrHandler,false),steps:[{label:"Browse",klass:BrowseBetsPanel},{label:"Edit",klass:EditBetPanel},{label:"Bet",klass:PlaceBetPanel}]});var a=$("div[id='app']")[0];ReactDOM.render(b,a)};